# Ejecutar como Administrador
$latest = [version]"7.5.2"
$installerUrl = "https://github.com/PowerShell/PowerShell/releases/download/v7.5.2/PowerShell-7.5.2-win-x64.msi"

Write-Host "üìã Versi√≥n actual de PowerShell:"
$instVer = $PSVersionTable.PSVersion
Write-Host "`t$instVer"

if ($instVer -ge $latest) {
    Write-Host "‚úÖ Ya tienes la √∫ltima versi√≥n estable instalada (v$latest)."
    return
}

Write-Host "‚¨áÔ∏è Descargando PowerShell v$latest..."
$msiPath = "$env:TEMP\PowerShell-$($latest).msi"
try {
    Invoke-WebRequest -Uri $installerUrl -OutFile $msiPath -UseBasicParsing -ErrorAction Stop
    Write-Host "üõ† Instalando PowerShell v$latest..."
    Start-Process msiexec.exe -ArgumentList "/i `"$msiPath`" /quiet /norestart" -Wait
    Remove-Item $msiPath -Force
    Write-Host "‚úÖ PowerShell v$latest instalado correctamente."
    Write-Host "‚ñ∂Ô∏è Para verificar, ejecuta:";
    Write-Host "`t& 'C:\Program Files\PowerShell\7\pwsh.exe' -Command '$PSVersionTable'"
} catch {
    Write-Error "‚ùå No se pudo actualizar PowerShell: $($_.Exception.Message)"
}
